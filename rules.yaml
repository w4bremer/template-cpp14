features:
  - name: api
    scopes:
      - match: system
        documents:
          - source: CMakeLists.txt.tpl
            target: CMakeLists.txt
            force: false
          - source: "README.md"
            raw: true
      - match: module
        prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/"
        documents:
          - source: "module/CMakeLists.txt.tpl"
            target: "CMakeLists.txt"
            force: true
          - source: "module/ModuleConfig.cmake.in.tpl"
            target: "{{upper1 (snake .Module.Name)}}Config.cmake.in"
            force: true
          - source: "module/generated/api/CMakeLists.txt.tpl"
            target: "generated/api/CMakeLists.txt"
            force: true
          - source: "module/generated/api/module.h.tpl"
            target: "generated/api/{{snake .Module.Name}}.h"
            force: true
          - source: "module/generated/api/module_common.h.tpl"
            target: "generated/api/common.h"
            force: true
          - source: "module/generated/api/datastructs.api.h.tpl"
            target: "generated/api/datastructs.api.h"
            force: true
          - source: "module/generated/api/datastructs.api.cpp.tpl"
            target: "generated/api/datastructs.api.cpp"
            force: true
      - match: interface
        prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/"
        documents:
        - source: "module/generated/api/interface.api.h.tpl"
          target: "generated/api/{{lower (camel .Interface.Name)}}.api.h"
  - name: core
    requires:
      - api
    scopes:
      - match: module
        prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/generated/core/"
        documents:
          - source: "module/generated/core/CMakeLists.txt.tpl"
            target: "CMakeLists.txt"
            force: true
          - source: "module/generated/core/main_test.cpp.tpl"
            target: "{{snake .Module.Name}}.test.cpp"
            force: true
          - source: "module/generated/core/json.adapter.h.tpl"
            target: "{{snake .Module.Name}}.json.adapter.h"
            force: true
          - source: "module/generated/core/json.adapter.cpp.tpl"
            target: "{{snake .Module.Name}}.json.adapter.cpp"
            force: true
      - match: interface
        prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/generated/core/"
        documents:
          - source: "module/generated/core/interface.data.h.tpl"
            target: "{{lower (camel .Interface.Name)}}.data.h"
          - source: "module/generated/core/interface.publisher.h.tpl"
            target: "{{lower (camel .Interface.Name)}}.publisher.h"
          - source: "module/generated/core/interface.publisher.cpp.tpl"
            target: "{{lower (camel .Interface.Name)}}.publisher.cpp"
          - source: "module/generated/core/interface.threadsafedecorator.h.tpl"
            target: "{{lower (camel .Interface.Name)}}.threadsafedecorator.h"
          - source: "module/generated/core/interface.threadsafedecorator.cpp.tpl"
            target: "{{lower (camel .Interface.Name)}}.threadsafedecorator.cpp"
  - name: stubs
    requires:
      - api
      - core
    scopes:
      - match: module
        documents:
          - source: "module/source/CMakeLists.txt.tpl"
            target: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/implementation/CMakeLists.txt"
            force: false
      - match: interface
        prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/implementation/"
        documents:
          - source: "module/source/implementation.h.tpl"
            target: "{{lower (camel .Interface.Name)}}.h"
            force: false
          - source: "module/source/implementation.cpp.tpl"
            target: "{{lower (camel .Interface.Name)}}.cpp"
            force: false
          - source: "module/source/implementation_test.cpp.tpl"
            target: "{{lower (camel .Interface.Name)}}.test.cpp"
            force: false
  - name: monitor
    requires:
      - api
      - core
      - apigear
    scopes:
    - match: module
      documents:
          - source: "module/generated/monitor/CMakeLists.txt.tpl"
            target: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/generated/monitor/CMakeLists.txt"
    - match: interface
      prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/generated/monitor/"
      documents:
          - source: "module/generated/monitor/interface.tracedecorator.h.tpl"
            target: "{{lower (camel .Interface.Name)}}.tracedecorator.h"
          - source: "module/generated/monitor/interface.tracedecorator.cpp.tpl"
            target: "{{lower (camel .Interface.Name)}}.tracedecorator.cpp"
          - source: "module/generated/monitor/interface.tracer.h.tpl"
            target: "{{lower (camel .Interface.Name)}}.tracer.h"
          - source: "module/generated/monitor/interface.tracer.cpp.tpl"
            target: "{{lower (camel .Interface.Name)}}.tracer.cpp"
  - name: olink
    requires:
      - api
      - core
      - apigear
    scopes:
    - match: system
      documents:
        - source: "Lifecycle for olink client-server implementation.md"
          raw: true
    - match: module
      documents:
          - source: "module/generated/olink/CMakeLists.txt.tpl"
            target: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/generated/olink/CMakeLists.txt"
    - match: interface
      prefix: "modules/{{snake .Module.Name}}_module/{{snake .Module.Name}}/generated/olink/"
      documents:
        - source: "module/generated/olink/interfaceservice.h.tpl"
          target: "{{lower (camel .Interface.Name)}}service.h"
        - source: "module/generated/olink/interfaceservice.cpp.tpl"
          target: "{{lower (camel .Interface.Name)}}service.cpp"
        - source: "module/generated/olink/interfaceclient.h.tpl"
          target: "{{lower (camel .Interface.Name)}}client.h"
        - source: "module/generated/olink/interfaceclient.cpp.tpl"
          target: "{{lower (camel .Interface.Name)}}client.cpp"
  - name: apigear
    scopes:
    - match: system
      documents:
        - source: "apigear/utilities/logger.cpp"
          raw: true
        - source: "apigear/utilities/logger.h"
          raw: true
        - source: "apigear/utilities/CMakeLists.txt"
          raw: true
        - source: "apigear/apigear.test.cpp"
          raw: true
        - source: "apigear/tracer/tracer.h"
          raw: true
        - source: "apigear/tracer/tracer.cpp"
          raw: true
        - source: "apigear/tracer/tracer.test.cpp"
          raw: true
        - source: "apigear/tracer/CMakeLists.txt"
          raw: true
        - source: "apigear/CMakeLists.txt"
          raw: true
        - source: "apigear/ApigearConfig.cmake.in"
          raw: true
        - source: "apigear/conanfile.py"
          raw: true
        - source: "apigear/olink/CMakeLists.txt"
          raw: true
        - source: "apigear/olink/olinkhost.cpp"
          raw: true
        - source: "apigear/olink/olinkhost.h"
          raw: true
        - source: "apigear/olink/olinkconnection.cpp"
          raw: true
        - source: "apigear/olink/olinkconnection.h"
          raw: true
        - source: "apigear/olink/iolinkconnector.h"
          raw: true
        - source: "apigear/olink/private/apigear_olink.h"
          raw: true
        - source: "apigear/olink/private/olinkremote.cpp"
          raw: true
        - source: "apigear/olink/private/olinkremote.h"
          raw: true
        - source: "apigear/olink/private/olinkwebsockethandler.cpp"
          raw: true
        - source: "apigear/olink/private/olinkwebsockethandler.h"
          raw: true
        - source: "apigear/olink/private/requesthandlerfactory.cpp"
          raw: true
        - source: "apigear/olink/private/requesthandlerfactory.h"
          raw: true
        - source: "apigear/olink/private/iconnectionstorage.h"
          raw: true
        - source: "apigear/olink/private/connectionstorage.cpp"
          raw: true
        - source: "apigear/olink/private/connectionstorage.h"
          raw: true
        - source: "apigear/olink/private/isocketuser.h"
          raw: true
        - source: "apigear/olink/private/socketwrapper.cpp"
          raw: true
        - source: "apigear/olink/private/socketwrapper.h"
          raw: true
        - source: "apigear/olink/tests/CMakeLists.txt"
          raw: true
        - source: "apigear/olink/tests/olink_connection.test.cpp"
          raw: true
        - source: "apigear/olink/tests/olinkhost.test.cpp"
          raw: true
        - source: "apigear/olink/tests/test_main.cpp"
          raw: true
        - source: "apigear/olink/tests/private/frame.hpp"
          raw: true
        - source: "apigear/olink/tests/private/sinkobjectmock.hpp"
          raw: true
        - source: "apigear/olink/tests/private/sourceobjectmock.hpp"
          raw: true
        - source: "apigear/olink/tests/private/test_server/test_server.hpp"
          raw: true
        - source: "apigear/olink/tests/private/test_server/test_server_request_factory.hpp"
          raw: true
        - source: "apigear/olink/tests/private/test_server/iframestorage.hpp"
          raw: true
        - source: "apigear/olink/tests/private/test_server/test_server_request_handler.hpp"
          raw: true
  - name: examples
    requires:
      - stubs
    scopes:
    - match: system
      documents:
        - source: examples/app/CMakeLists.txt.tpl
          target: examples/app/CMakeLists.txt
        - source: examples/app/conanfile.txt.tpl
          target: examples/app/conanfile.txt
        - source: examples/app/main.cpp.tpl
          target: examples/app/main.cpp
        - source: examples/appthreadsafe/CMakeLists.txt.tpl
          target: examples/appthreadsafe/CMakeLists.txt
        - source: examples/appthreadsafe/conanfile.txt.tpl
          target: examples/appthreadsafe/conanfile.txt
        - source: examples/appthreadsafe/main.cpp.tpl
          target: examples/appthreadsafe/main.cpp
  - name: examples_olink
    requires:
      - stubs
      - olink
    scopes:
    - match: system
      documents:
        - source: examples/olinkserver/CMakeLists.txt.tpl
          target: examples/olinkserver/CMakeLists.txt
        - source: examples/olinkserver/conanfile.txt.tpl
          target: examples/olinkserver/conanfile.txt
        - source: examples/olinkserver/main.cpp.tpl
          target: examples/olinkserver/main.cpp
        - source: examples/olinkclient/CMakeLists.txt.tpl
          target: examples/olinkclient/CMakeLists.txt
        - source: examples/olinkclient/conanfile.txt.tpl
          target: examples/olinkclient/conanfile.txt
        - source: examples/olinkclient/main.cpp.tpl
          target: examples/olinkclient/main.cpp
  - name: conan
    requires:
      - api
    scopes:
    - match: system
      documents:
        - source: test_conan.sh.tpl
          target: test_conan.sh
          force: false
        - source: test_conan.bat.tpl
          target: test_conan.bat
          force: false
    - match: module
      prefix: "modules//{{snake .Module.Name}}_module/"
      documents:
        - source: module/conanfile.py.tpl
          target: "conanfile.py"
          force: false
        - source: module/test_package/CMakeLists.txt.tpl
          target: "test_package/CMakeLists.txt"
          force: false
        - source: module/test_package/conanfile.py.tpl
          target: "test_package/conanfile.py"
          force: false
        - source: module/test_package/main.cpp.tpl
          target: "test_package/main.cpp"
          force: false
